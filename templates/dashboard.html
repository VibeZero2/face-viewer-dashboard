{% extends "base.html" %}
{% block content %}
<h1 class="mb-4">Dashboard</h1>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-warning mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Participants</h5>
                <p class="card-text display-6">
                    {% if stats and stats.total_participants is defined %}{{ stats.total_participants }}{% else %}N/A{% endif %}
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-primary mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Responses</h5>
                <p class="card-text display-6">
                    {% if stats and stats.total_responses is defined %}{{ stats.total_responses }}{% else %}N/A{% endif %}
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-success mb-3">
            <div class="card-body">
                <h5 class="card-title">Avg Trust Rating</h5>
                <p class="card-text display-6">
                    {% if stats and stats.trust_mean is defined %}{{ stats.trust_mean }}{% else %}N/A{% endif %}
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-danger mb-3">
            <div class="card-body">
                <h5 class="card-title">Std Dev</h5>
                <p class="card-text display-6">
                    {% if stats and stats.trust_std is defined %}{{ stats.trust_std }}{% else %}N/A{% endif %}
                </p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">Trust Rating Distribution</div>
            <div class="card-body">
                <canvas id="trustChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">Masculinity Scores</div>
            <div class="card-body">
                <canvas id="masculinityChart"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-header">Participants</div>
    <div class="card-body table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Participant ID</th>
                    <th>Files</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for p in participants %}
                <tr>
                    <td>{{ p.id }}</td>
                    <td>
                        {% if p.csv %}<span class="badge bg-success">CSV</span>{% endif %}
                        {% if p.xlsx %}<span class="badge bg-info">XLSX</span>{% endif %}
                        {% if p.enc %}<span class="badge bg-warning">ENC</span>{% endif %}
                    </td>
                    <td>
                        {% if p.csv %}<a href="{{ p.csv }}" class="btn btn-outline-primary btn-sm">View</a>{% endif %}
                        {% if p.csv %}<a href="{{ p.csv }}" download class="btn btn-outline-secondary btn-sm">Download</a>{% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
